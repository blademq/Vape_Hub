<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>VapeHub | Магазин вейп-продукции</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
}



:root {
  --primary: #8a2be2;
  --primary-dark: #6a1cb0;
  --secondary: #ff6b9d;
  --dark: #0c0c14;
  --dark-light: #1a1a24;
  --darker: #07070c;
  --light: #f0f0f5;
  --gray: #a0a0b0;
  --success: #2be28a;
  --danger: #ff4757;
  --warning: #ffa502;
  --chaser-blue: #0066cc;
  --chaser-light: #3399ff;
  --elfiq-green: #00cc66;
}

body {
  background-color: var(--dark);
  color: var(--light);
  min-height: 100vh;
  padding-bottom: 70px;
}

/* Header стили */
header {
  background: linear-gradient(135deg, var(--darker) 0%, var(--dark) 100%);
  padding: 16px 20px;
  display: flex;
  justify-content: space-between;
  align-items: center;
  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
  position: sticky;
  top: 0;
  z-index: 100;
}

.logo {
  display: flex;
  align-items: center;
  gap: 10px;
  cursor: pointer;
}

.logo-icon {
  color: var(--primary);
  font-size: 24px;
}

.logo-text {
  font-weight: 700;
  font-size: 22px;
  background: linear-gradient(to right, var(--primary), var(--secondary));
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
}

.currency {
  font-size: 12px;
  color: var(--gray);
  margin-left: 5px;
}

.header-actions {
  display: flex;
  gap: 15px;
}

.icon-btn {
  background: var(--dark-light);
  width: 40px;
  height: 40px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: all 0.3s;
  position: relative;
}

.icon-btn:hover {
  background: var(--primary);
  transform: translateY(-2px);
}

/* Поиск */
.search-container {
  margin: 20px;
  position: relative;
}

.search-box {
  background: var(--dark-light);
  border-radius: 50px;
  padding: 14px 20px;
  display: flex;
  align-items: center;
  box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
  border: 1px solid rgba(138, 43, 226, 0.2);
  transition: all 0.3s;
}

.search-box:focus-within {
  border-color: var(--primary);
  box-shadow: 0 5px 20px rgba(138, 43, 226, 0.3);
}

.search-box i {
  color: var(--gray);
  margin-right: 10px;
}

.search-box input {
  flex: 1;
  background: none;
  border: none;
  color: var(--light);
  font-size: 16px;
  outline: none;
}

.search-box input::placeholder {
  color: var(--gray);
}

/* Секции */
.section {
  padding: 0 20px;
  margin-bottom: 25px;
}

.section-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 15px;
}

.section-title {
  font-size: 20px;
  font-weight: 600;
}

.section-link {
  color: var(--primary);
  font-size: 14px;
  text-decoration: none;
  display: flex;
  align-items: center;
  gap: 5px;
  cursor: pointer;
}

/* Категории */
.categories {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 15px;
  margin-bottom: 25px;
}

.category-card {
  background: var(--dark-light);
  border-radius: 20px;
  padding: 20px;
  cursor: pointer;
  transition: all 0.3s;
  position: relative;
  overflow: hidden;
  display: flex;
  flex-direction: column;
  align-items: center;
  text-align: center;
  box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.05);
}

.category-card:hover {
  transform: translateY(-5px);
  box-shadow: 0 10px 20px rgba(138, 43, 226, 0.2);
  background: linear-gradient(135deg, var(--dark-light) 0%, rgba(138, 43, 226, 0.1) 100%);
}

.category-card.liquids {
  background: linear-gradient(135deg, #1a1a24 0%, #1a2a36 100%);
  border-color: rgba(0, 102, 204, 0.3);
}

.category-card.liquids:hover {
  background: linear-gradient(135deg, #1a2a36 0%, rgba(0, 102, 204, 0.2) 100%);
  box-shadow: 0 10px 20px rgba(0, 102, 204, 0.2);
}

.category-icon {
  font-size: 32px;
  margin-bottom: 10px;
  color: var(--primary);
}

.category-card.liquids .category-icon {
  color: var(--chaser-light);
}

.category-name {
  font-weight: 600;
  font-size: 16px;
}

.category-count {
  font-size: 12px;
  color: var(--gray);
  margin-top: 5px;
}

/* Товары */
.products-grid {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 15px;
  margin-bottom: 30px;
}

.product-card {
  background: var(--dark-light);
  border-radius: 18px;
  overflow: hidden;
  box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
  transition: all 0.3s;
  border: 1px solid rgba(255, 255, 255, 0.05);
}

.product-card:hover {
  transform: translateY(-5px);
  box-shadow: 0 10px 25px rgba(138, 43, 226, 0.2);
}

.product-card.chaser {
  border-color: rgba(0, 102, 204, 0.3);
}

.product-card.elfiq {
  border-color: rgba(0, 204, 102, 0.3);
}

.product-image {
  height: 140px;
  background: linear-gradient(135deg, #1a1a24 0%, #2a1a36 100%);
  display: flex;
  align-items: center;
  justify-content: center;
  position: relative;
}

.product-card.chaser .product-image {
  background: linear-gradient(135deg, #0a1a2a 0%, #1a2a3a 100%);
}

.product-card.elfiq .product-image {
  background: linear-gradient(135deg, #0a2a1a 0%, #1a3a2a 100%);
}

.product-image i {
  font-size: 50px;
  color: var(--primary);
  opacity: 0.7;
}

.product-card.chaser .product-image i {
  color: var(--chaser-light);
}

.product-card.elfiq .product-image i {
  color: var(--elfiq-green);
}

.product-badge {
  position: absolute;
  top: 10px;
  right: 10px;
  background: var(--secondary);
  color: white;
  font-size: 10px;
  padding: 3px 8px;
  border-radius: 10px;
  font-weight: 600;
}

.product-info {
  padding: 15px;
}

.product-name {
  font-weight: 600;
  margin-bottom: 5px;
  font-size: 16px;
}

.product-category {
  font-size: 12px;
  color: var(--gray);
  margin-bottom: 10px;
}

.product-price {
  font-weight: 700;
  color: var(--primary);
  margin-bottom: 15px;
}

.product-card.chaser .product-price {
  color: var(--chaser-light);
}

.product-card.elfiq .product-price {
  color: var(--elfiq-green);
}

.product-actions {
  display: flex;
  justify-content: space-between;
}

.btn-cart {
  background: linear-gradient(to right, var(--primary), var(--primary-dark));
  color: white;
  border: none;
  padding: 8px 15px;
  border-radius: 10px;
  font-weight: 600;
  font-size: 14px;
  cursor: pointer;
  transition: all 0.3s;
  flex: 1;
  margin-right: 8px;
}

.btn-cart:hover {
  background: linear-gradient(to right, var(--primary-dark), var(--primary));
  box-shadow: 0 5px 15px rgba(138, 43, 226, 0.3);
}

.product-card.chaser .btn-cart {
  background: linear-gradient(to right, var(--chaser-blue), #004499);
}

.product-card.chaser .btn-cart:hover {
  background: linear-gradient(to right, #004499, var(--chaser-blue));
  box-shadow: 0 5px 15px rgba(0, 102, 204, 0.3);
}

.product-card.elfiq .btn-cart {
  background: linear-gradient(to right, var(--elfiq-green), #00994d);
}

.product-card.elfiq .btn-cart:hover {
  background: linear-gradient(to right, #00994d, var(--elfiq-green));
  box-shadow: 0 5px 15px rgba(0, 204, 102, 0.3);
}

.btn-fav {
  background: var(--dark);
  color: var(--gray);
  border: none;
  width: 36px;
  height: 36px;
  border-radius: 10px;
  cursor: pointer;
  transition: all 0.3s;
}

.btn-fav.active {
  color: var(--secondary);
  background: rgba(255, 107, 157, 0.1);
}

.btn-fav:hover {
  color: var(--secondary);
  background: rgba(255, 107, 157, 0.1);
}

/* Футер навигация */
.nav-footer {
  position: fixed;
  bottom: 0;
  left: 0;
  right: 0;
  background: var(--darker);
  display: flex;
  justify-content: space-around;
  padding: 12px 0;
  box-shadow: 0 -5px 20px rgba(0, 0, 0, 0.3);
  z-index: 100;
}

.nav-item {
  display: flex;
  flex-direction: column;
  align-items: center;
  cursor: pointer;
  transition: all 0.3s;
  padding: 5px 15px;
  border-radius: 12px;
  position: relative;
}

.nav-item i {
  font-size: 20px;
  margin-bottom: 4px;
}

.nav-item span {
  font-size: 12px;
}

.nav-item.active {
  color: var(--primary);
  background: rgba(138, 43, 226, 0.1);
}

.nav-item:hover:not(.active) {
  color: var(--gray);
}

.cart-badge, .fav-badge {
  position: absolute;
  top: -5px;
  right: 5px;
  background: var(--secondary);
  color: white;
  font-size: 10px;
  width: 18px;
  height: 18px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: 700;
}

.fav-badge {
  background: var(--danger);
}

/* Страница выбора жидкостей */
.liquids-page {
  display: none;
}

.liquid-categories {
  display: flex;
  flex-direction: column;
  gap: 15px;
  margin-bottom: 25px;
}

.liquid-category-card {
  background: var(--dark-light);
  border-radius: 18px;
  padding: 20px;
  cursor: pointer;
  transition: all 0.3s;
  display: flex;
  align-items: center;
  box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.05);
}

.liquid-category-card:hover {
  transform: translateY(-3px);
  box-shadow: 0 8px 20px rgba(138, 43, 226, 0.2);
  background: linear-gradient(135deg, var(--dark-light) 0%, rgba(138, 43, 226, 0.1) 100%);
}

.liquid-category-card.chaser {
  border-color: rgba(0, 102, 204, 0.3);
  background: linear-gradient(135deg, #1a1a24 0%, #1a2a36 100%);
}

.liquid-category-card.chaser:hover {
  background: linear-gradient(135deg, #1a2a36 0%, rgba(0, 102, 204, 0.2) 100%);
  box-shadow: 0 8px 20px rgba(0, 102, 204, 0.2);
}

.liquid-category-card.elfiq {
  border-color: rgba(0, 204, 102, 0.3);
  background: linear-gradient(135deg, #1a1a24 0%, #1a2a1a 100%);
}

.liquid-category-card.elfiq:hover {
  background: linear-gradient(135deg, #1a2a1a 0%, rgba(0, 204, 102, 0.2) 100%);
  box-shadow: 0 8px 20px rgba(0, 204, 102, 0.2);
}

.liquid-category-icon {
  font-size: 36px;
  margin-right: 15px;
  color: var(--primary);
}

.liquid-category-card.chaser .liquid-category-icon {
  color: var(--chaser-light);
}

.liquid-category-card.elfiq .liquid-category-icon {
  color: var(--elfiq-green);
}

.liquid-category-info {
  flex: 1;
}

.liquid-category-name {
  font-weight: 700;
  font-size: 18px;
  margin-bottom: 5px;
}

.liquid-category-description {
  font-size: 13px;
  color: var(--gray);
}

.liquid-category-arrow {
  color: var(--gray);
  font-size: 20px;
}

/* Страница конкретной жидкости */
.liquid-type-page {
  display: none;
}

.liquid-type-header {
  display: flex;
  align-items: center;
  gap: 15px;
  margin-bottom: 20px;
  padding: 0 20px;
}

.liquid-type-icon {
  font-size: 40px;
  color: var(--chaser-light);
}

.liquid-type-info {
  flex: 1;
}

.liquid-type-title {
  font-size: 24px;
  font-weight: 700;
  margin-bottom: 5px;
}

.liquid-type-description {
  color: var(--gray);
  font-size: 14px;
}

.liquid-type-products {
  padding: 0 20px;
}

/* Страница корзины */
.cart-page, .favorites-page {
  display: none;
}

.cart-item, .favorite-item {
  background: var(--dark-light);
  border-radius: 18px;
  padding: 15px;
  margin-bottom: 15px;
  display: flex;
  align-items: center;
  box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
}

.cart-item-image, .favorite-item-image {
  width: 70px;
  height: 70px;
  background: linear-gradient(135deg, #1a1a24 0%, #2a1a36 100%);
  border-radius: 12px;
  display: flex;
  align-items: center;
  justify-content: center;
  margin-right: 15px;
  flex-shrink: 0;
}

.cart-item-info, .favorite-item-info {
  flex: 1;
}

.cart-item-name, .favorite-item-name {
  font-weight: 600;
  margin-bottom: 5px;
}

.cart-item-category, .favorite-item-category {
  font-size: 12px;
  color: var(--gray);
  margin-bottom: 5px;
}

.cart-item-price, .favorite-item-price {
  font-weight: 700;
  color: var(--primary);
}

.cart-item-actions, .favorite-item-actions {
  display: flex;
  flex-direction: column;
  gap: 10px;
}

.btn-remove {
  background: var(--danger);
  color: white;
  border: none;
  width: 36px;
  height: 36px;
  border-radius: 10px;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.3s;
}

.btn-remove:hover {
  background: #ff2e43;
  transform: scale(1.1);
}

.cart-summary, .favorites-empty {
  background: var(--dark-light);
  border-radius: 20px;
  padding: 20px;
  margin: 20px;
  box-shadow: 0 5px 20px rgba(0, 0, 0, 0.2);
}

.cart-total {
  display: flex;
  justify-content: space-between;
  font-size: 18px;
  font-weight: 700;
  margin-bottom: 20px;
  padding-bottom: 15px;
  border-bottom: 1px solid rgba(255, 255, 255, 0.1);
}

.cart-total-amount {
  color: var(--primary);
}

.telegram-payment {
  background: #2aabee;
  color: white;
  border: none;
  padding: 16px;
  border-radius: 12px;
  font-weight: 600;
  font-size: 16px;
  cursor: pointer;
  transition: all 0.3s;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 10px;
  width: 100%;
  margin-top: 10px;
}

.telegram-payment:hover {
  background: #229ed9;
  transform: translateY(-2px);
  box-shadow: 0 8px 20px rgba(42, 171, 238, 0.3);
}

.payment-info {
  margin-top: 20px;
  padding: 15px;
  background: rgba(42, 171, 238, 0.1);
  border-radius: 12px;
  text-align: center;
}

.payment-info p {
  margin-bottom: 10px;
  color: var(--gray);
}

.telegram-username {
  background: var(--dark);
  padding: 10px 15px;
  border-radius: 10px;
  font-family: monospace;
  color: var(--primary);
  font-weight: 600;
  display: inline-block;
  margin: 10px 0;
}

.empty-state {
  text-align: center;
  padding: 40px 20px;
}

.empty-state i {
  font-size: 60px;
  color: var(--gray);
  margin-bottom: 20px;
  opacity: 0.5;
}

.empty-state h3 {
  margin-bottom: 10px;
  color: var(--light);
}

.empty-state p {
  color: var(--gray);
  margin-bottom: 20px;
}

/* Админ панель */
.admin-panel {
  background: var(--dark-light);
  border-radius: 20px;
  padding: 25px;
  margin: 20px;
  box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
  display: none;
}

.admin-title {
  font-size: 22px;
  margin-bottom: 20px;
  color: var(--primary);
  display: flex;
  align-items: center;
  gap: 10px;
}

.admin-tabs {
  display: flex;
  gap: 10px;
  margin-bottom: 20px;
  border-bottom: 1px solid rgba(255, 255, 255, 0.1);
  padding-bottom: 10px;
}

.admin-tab {
  padding: 10px 20px;
  background: var(--dark);
  border-radius: 10px;
  cursor: pointer;
  transition: all 0.3s;
  font-weight: 600;
  color: var(--gray);
}

.admin-tab.active {
  background: var(--primary);
  color: white;
}

.admin-tab:hover:not(.active) {
  color: var(--light);
}

.admin-form {
  display: flex;
  flex-direction: column;
  gap: 15px;
}

.form-input {
  background: var(--dark);
  border: 1px solid rgba(138, 43, 226, 0.3);
  border-radius: 12px;
  padding: 14px;
  color: var(--light);
  font-size: 16px;
  outline: none;
  transition: all 0.3s;
}

.form-input:focus {
  border-color: var(--primary);
  box-shadow: 0 0 0 2px rgba(138, 43, 226, 0.2);
}

.form-select {
  background: var(--dark);
  border: 1px solid rgba(138, 43, 226, 0.3);
  border-radius: 12px;
  padding: 14px;
  color: var(--light);
  font-size: 16px;
  outline: none;
  cursor: pointer;
}

.btn-primary {
  background: linear-gradient(to right, var(--primary), var(--primary-dark));
  color: white;
  border: none;
  padding: 14px;
  border-radius: 12px;
  font-weight: 600;
  font-size: 16px;
  cursor: pointer;
  transition: all 0.3s;
}

.btn-primary:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 20px rgba(138, 43, 226, 0.3);
}

.btn-secondary {
  background: transparent;
  color: var(--gray);
  border: 1px solid var(--gray);
  padding: 14px;
  border-radius: 12px;
  font-weight: 600;
  font-size: 16px;
  cursor: pointer;
  transition: all 0.3s;
}

.btn-secondary:hover {
  color: var(--light);
  border-color: var(--light);
}

.btn-warning {
  background: var(--warning);
  color: white;
  border: none;
  padding: 8px 15px;
  border-radius: 8px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.3s;
}

.btn-warning:hover {
  background: #e59400;
}

/* Список товаров в админке */
.admin-products, .admin-categories {
  margin-top: 25px;
  max-height: 400px;
  overflow-y: auto;
}

.admin-product-item, .admin-category-item {
  background: var(--dark);
  border-radius: 12px;
  padding: 15px;
  margin-bottom: 10px;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.admin-product-info, .admin-category-info {
  flex: 1;
}

.admin-product-name, .admin-category-name {
  font-weight: 600;
  margin-bottom: 5px;
}

.admin-product-category, .admin-category-count {
  font-size: 12px;
  color: var(--gray);
}

.admin-product-price {
  font-weight: 700;
  color: var(--primary);
  margin-right: 15px;
}

.admin-product-actions, .admin-category-actions {
  display: flex;
  gap: 10px;
}

.btn-delete {
  background: var(--danger);
  color: white;
  border: none;
  width: 36px;
  height: 36px;
  border-radius: 10px;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.3s;
}

.btn-delete:hover {
  background: #ff2e43;
  transform: scale(1.1);
}

/* Управление категориями */
.categories-management {
  display: none;
}

.category-input-group {
  display: flex;
  gap: 10px;
}

.category-input-group .form-input {
  flex: 1;
}

/* Страница категории */
.category-page {
  display: none;
}

.back-btn {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 15px 20px;
  cursor: pointer;
  color: var(--primary);
  font-weight: 600;
}

.back-btn i {
  font-size: 18px;
}

/* Анимации */
@keyframes fadeIn {
  from { opacity: 0; transform: translateY(10px); }
  to { opacity: 1; transform: translateY(0); }
}

.fade-in {
  animation: fadeIn 0.3s ease-out;
}

/* Адаптивность */
@media (min-width: 768px) {
  .categories {
    grid-template-columns: repeat(4, 1fr);
  }
  
  .products-grid {
    grid-template-columns: repeat(3, 1fr);
  }
  
  .section {
    padding: 0 30px;
  }
  
  .cart-item, .favorite-item {
    padding: 20px;
  }
  
  .cart-item-image, .favorite-item-image {
    width: 90px;
    height: 90px;
  }
  
  .category-input-group {
    flex-direction: row;
  }
  
  .liquid-categories {
    flex-direction: row;
    flex-wrap: wrap;
  }
  
  .liquid-category-card {
    flex: 1;
    min-width: 200px;
  }
}
</style>
</head>
<body>

<header>
  <div class="logo" onclick="goToHome()">
    <div class="logo-icon">
      <i class="fas fa-cloud"></i>
    </div>
    <div class="logo-text">VapeHub<span class="currency">(zł)</span></div>
  </div>
  
  <div class="header-actions">
    <div class="icon-btn" onclick="openFavorites()">
      <i class="fas fa-heart"></i>
      <div class="fav-badge" id="fav-badge">0</div>
    </div>
    <div class="icon-btn" onclick="openAdmin()">
      <i class="fas fa-user-cog"></i>
    </div>
  </div>
</header>

<main>
  <!-- Главная страница магазина -->
  <div id="shop-page">
    <div class="search-container">
      <div class="search-box">
        <i class="fas fa-search"></i>
        <input type="text" id="searchInput" placeholder="Поиск жидкостей, устройств..." oninput="searchProducts(this.value)">
      </div>
    </div>
    
    <div class="section">
      <div class="section-header">
        <div class="section-title">Категории</div>
      </div>
      
      <div class="categories" id="categories-container">
        <!-- Категории будут добавлены через JS -->
      </div>
    </div>
    
    <div class="section">
      <div class="section-header">
        <div class="section-title">Популярные товары</div>
        <a class="section-link" onclick="showAllProducts()">
          Все товары <i class="fas fa-arrow-right"></i>
        </a>
      </div>
      
      <div class="products-grid" id="products-container">
        <!-- Товары будут добавлены через JS -->
      </div>
    </div>
  </div>
  
  <!-- Страница категории -->
  <div id="category-page" class="category-page">
    <div class="back-btn" onclick="backToShop()">
      <i class="fas fa-arrow-left"></i>
      <span>Назад в каталог</span>
    </div>
    
    <div class="section">
      <div class="section-header">
        <div class="section-title" id="category-title">Категория</div>
      </div>
      
      <div class="products-grid" id="category-products">
        <!-- Товары категории будут добавлены через JS -->
      </div>
    </div>
  </div>
  
  <!-- Страница выбора жидкостей -->
  <div id="liquids-page" class="liquids-page">
    <div class="back-btn" onclick="backToShop()">
      <i class="fas fa-arrow-left"></i>
      <span>Назад в каталог</span>
    </div>
    
    <div class="section">
      <div class="section-header">
        <div class="section-title">Выбор жидкостей</div>
      </div>
      
      <div class="liquid-categories">
        <div class="liquid-category-card chaser" onclick="openLiquidType('Chaser Lux')">
          <div class="liquid-category-icon">
            <i class="fas fa-crown"></i>
          </div>
          <div class="liquid-category-info">
            <div class="liquid-category-name">Chaser Lux</div>
            <div class="liquid-category-description">Премиальная линейка солей для POD-систем</div>
          </div>
          <div class="liquid-category-arrow">
            <i class="fas fa-chevron-right"></i>
          </div>
        </div>
        
        <div class="liquid-category-card chaser" onclick="openLiquidType('Chaser for pods')">
          <div class="liquid-category-icon">
            <i class="fas fa-podcast"></i>
          </div>
          <div class="liquid-category-info">
            <div class="liquid-category-name">Chaser for pods</div>
            <div class="liquid-category-description">Специально разработан для POD-систем</div>
          </div>
          <div class="liquid-category-arrow">
            <i class="fas fa-chevron-right"></i>
          </div>
        </div>
        
        <div class="liquid-category-card chaser" onclick="openLiquidType('CHASER LIMITINI EDITINI')">
          <div class="liquid-category-icon">
            <i class="fas fa-gem"></i>
          </div>
          <div class="liquid-category-info">
            <div class="liquid-category-name">CHASER LIMITINI EDITINI</div>
            <div class="liquid-category-description">Лимитированная серия с уникальными вкусами</div>
          </div>
          <div class="liquid-category-arrow">
            <i class="fas fa-chevron-right"></i>
          </div>
        </div>
        
        <div class="liquid-category-card elfiq" onclick="openLiquidType('Elfliq')">
          <div class="liquid-category-icon">
            <i class="fas fa-leaf"></i>
          </div>
          <div class="liquid-category-info">
            <div class="liquid-category-name">Elfliq</div>
            <div class="liquid-category-description">Популярная линейка солей от Elf Bar</div>
          </div>
          <div class="liquid-category-arrow">
            <i class="fas fa-chevron-right"></i>
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <!-- Страница конкретной жидкости -->
  <div id="liquid-type-page" class="liquid-type-page">
    <div class="back-btn" onclick="backToLiquids()">
      <i class="fas fa-arrow-left"></i>
      <span>Назад к выбору жидкостей</span>
    </div>
    
    <div class="liquid-type-header">
      <div class="liquid-type-icon" id="liquid-type-icon">
        <i class="fas fa-crown"></i>
      </div>
      <div class="liquid-type-info">
        <div class="liquid-type-title" id="liquid-type-title">Chaser Lux</div>
        <div class="liquid-type-description" id="liquid-type-description">Премиальная линейка солей для POD-систем</div>
      </div>
    </div>
    
    <div class="liquid-type-products">
      <div class="products-grid" id="liquid-type-products">
        <!-- Товары конкретного типа жидкости будут добавлены через JS -->
      </div>
    </div>
  </div>
  
  <!-- Страница корзины -->
  <div id="cart-page" class="cart-page">
    <div class="back-btn" onclick="backToShop()">
      <i class="fas fa-arrow-left"></i>
      <span>Назад в каталог</span>
    </div>
    
    <div class="section">
      <div class="section-header">
        <div class="section-title">Корзина</div>
      </div>
      
      <div id="cart-items-container">
        <!-- Товары в корзине будут добавлены через JS -->
      </div>
      
      <div id="cart-summary-container">
        <!-- Сумма заказа будет добавлена через JS -->
      </div>
    </div>
  </div>
  
  <!-- Страница избранного -->
  <div id="favorites-page" class="favorites-page">
    <div class="back-btn" onclick="backToShop()">
      <i class="fas fa-arrow-left"></i>
      <span>Назад в каталог</span>
    </div>
    
    <div class="section">
      <div class="section-header">
        <div class="section-title">Избранное</div>
      </div>
      
      <div id="favorites-container">
        <!-- Избранные товары будут добавлены через JS -->
      </div>
    </div>
  </div>
  
  <!-- Админ панель -->
  <div id="admin-panel" class="admin-panel">
    <div class="admin-title">
      <i class="fas fa-user-cog"></i>
      <span>Панель администратора</span>
    </div>
    
    <div class="admin-tabs">
      <div class="admin-tab active" onclick="switchAdminTab('products')">Товары</div>
      <div class="admin-tab" onclick="switchAdminTab('categories')">Категории</div>
    </div>
    
    <!-- Вкладка товаров -->
    <div id="products-tab" class="admin-tab-content">
      <div class="admin-form">
        <input type="text" id="product-name" class="form-input" placeholder="Название товара">
        
        <select id="product-category" class="form-select">
          <option value="" disabled selected>Выберите категорию</option>
          <!-- Категории будут добавлены через JS -->
        </select>
        
        <select id="liquid-type" class="form-select">
          <option value="" disabled selected>Тип жидкости (если применимо)</option>
          <option value="Chaser Lux">Chaser Lux</option>
          <option value="Chaser for pods">Chaser for pods</option>
          <option value="CHASER LIMITINI EDITINI">CHASER LIMITINI EDITINI</option>
          <option value="Elfliq">Elfliq</option>
          <option value="Другое">Другое</option>
        </select>
        
        <input type="number" id="product-price" class="form-input" placeholder="Цена (zł)" min="1" step="0.01">
        
        <button class="btn-primary" onclick="addProduct()">Добавить товар</button>
      </div>
      
      <div class="admin-products">
        <div class="section-header">
          <div class="section-title">Управление товарами</div>
        </div>
        
        <div id="admin-products-list">
          <!-- Список товаров для удаления будет добавлен через JS -->
        </div>
      </div>
    </div>
    
    <!-- Вкладка категорий -->
    <div id="categories-tab" class="admin-tab-content categories-management">
      <div class="admin-form">
        <div class="category-input-group">
          <input type="text" id="category-name" class="form-input" placeholder="Название категории">
          <select id="category-icon" class="form-select" style="flex: 0 0 120px;">
            <option value="fa-tint">Капля</option>
            <option value="fa-smoking">Дым</option>
            <option value="fa-mobile-alt">Устройство</option>
            <option value="fa-prescription-bottle">Флакон</option>
            <option value="fa-battery-full">Батарея</option>
            <option value="fa-fire">Огонь</option>
          </select>
        </div>
        
        <button class="btn-primary" onclick="addCategory()">Добавить категорию</button>
      </div>
      
      <div class="admin-categories">
        <div class="section-header">
          <div class="section-title">Управление категориями</div>
        </div>
        
        <div id="admin-categories-list">
          <!-- Список категорий для редактирования будет добавлен через JS -->
        </div>
      </div>
    </div>
    
    <button class="btn-secondary" onclick="closeAdmin()" style="margin-top: 20px;">Закрыть панель</button>
  </div>
</main>

<!-- Нижняя навигация -->
<div class="nav-footer">
  <div class="nav-item active" onclick="goToHome()">
    <i class="fas fa-store"></i>
    <span>Каталог</span>
  </div>
  
  <div class="nav-item" onclick="openCartPage()">
    <i class="fas fa-shopping-cart"></i>
    <span>Корзина</span>
    <div class="cart-badge" id="cart-badge">0</div>
  </div>
  
  <div class="nav-item" onclick="openFavoritesPage()">
    <i class="fas fa-heart"></i>
    <span>Избранное</span>
    <div class="fav-badge" id="nav-fav-badge">0</div>
  </div>
  
  <div class="nav-item">
    <i class="fas fa-user"></i>
    <span>Профиль</span>
  </div>
</div>

<script>
// Инициализация данных
let categories = JSON.parse(localStorage.getItem('vapeCategories')) || [
  { id: 1, name: 'Жидкости', icon: 'fa-tint', subcategories: [] },
  { id: 2, name: 'Одноразки', icon: 'fa-smoking', subcategories: [] },
  { id: 3, name: 'Поды', icon: 'fa-mobile-alt', subcategories: [] },
  { id: 4, name: 'Картриджи', icon: 'fa-prescription-bottle', subcategories: [] }
];

let products = JSON.parse(localStorage.getItem('vapeProducts')) || [
  // Chaser Lux 30ml 5%
  { id: 1, name: 'Chaser Lux 30ml 5% - Манго Лед', category: 'Жидкости', liquidType: 'Chaser Lux', price: 45.90, isNew: true, brand: 'chaser' },
  { id: 2, name: 'Chaser Lux 30ml 5% - Кола Лед', category: 'Жидкости', liquidType: 'Chaser Lux', price: 45.90, isNew: true, brand: 'chaser' },
  { id: 3, name: 'Chaser Lux 30ml 5% - Арбуз Лед', category: 'Жидкости', liquidType: 'Chaser Lux', price: 45.90, brand: 'chaser' },
  { id: 4, name: 'Chaser Lux 30ml 5% - Клубника Банан', category: 'Жидкости', liquidType: 'Chaser Lux', price: 45.90, brand: 'chaser' },
  
  // Chaser Lux 30ml 6%
  { id: 5, name: 'Chaser Lux 30ml 6% - Манго Лед', category: 'Жидкости', liquidType: 'Chaser Lux', price: 46.90, isNew: true, brand: 'chaser' },
  { id: 6, name: 'Chaser Lux 30ml 6% - Кола Лед', category: 'Жидкости', liquidType: 'Chaser Lux', price: 46.90, brand: 'chaser' },
  { id: 7, name: 'Chaser Lux 30ml 6% - Дыня Лед', category: 'Жидкости', liquidType: 'Chaser Lux', price: 46.90, brand: 'chaser' },
  
  // Chaser for pods 30ml 5%
  { id: 8, name: 'Chaser for pods 30ml 5% - Манго Лед', category: 'Жидкости', liquidType: 'Chaser for pods', price: 44.90, brand: 'chaser' },
  { id: 9, name: 'Chaser for pods 30ml 5% - Кола Лед', category: 'Жидкости', liquidType: 'Chaser for pods', price: 44.90, brand: 'chaser' },
  { id: 10, name: 'Chaser for pods 30ml 5% - Арбуз Лед', category: 'Жидкости', liquidType: 'Chaser for pods', price: 44.90, brand: 'chaser' },
  { id: 11, name: 'Chaser for pods 30ml 5% - Клубника Банан', category: 'Жидкости', liquidType: 'Chaser for pods', price: 44.90, brand: 'chaser' },
  
  // CHASER LIMITINI EDITINI 30ML 5%
  { id: 12, name: 'CHASER LIMITINI EDITINI 30ML 5% - Красный Апельсин', category: 'Жидкости', liquidType: 'CHASER LIMITINI EDITINI', price: 47.90, isNew: true, brand: 'chaser' },
  { id: 13, name: 'CHASER LIMITINI EDITINI 30ML 5% - Голубика Малина', category: 'Жидкости', liquidType: 'CHASER LIMITINI EDITINI', price: 47.90, isNew: true, brand: 'chaser' },
  { id: 14, name: 'CHASER LIMITINI EDITINI 30ML 5% - Манго Кокос', category: 'Жидкости', liquidType: 'CHASER LIMITINI EDITINI', price: 47.90, brand: 'chaser' },
  
  // Elfliq 30ml 5%
  { id: 15, name: 'Elfliq 30ml 5% - Манго Персик Ананас', category: 'Жидкости', liquidType: 'Elfliq', price: 48.90, isNew: true, brand: 'elfiq' },
  { id: 16, name: 'Elfliq 30ml 5% - Кола Лед', category: 'Жидкости', liquidType: 'Elfliq', price: 48.90, isNew: true, brand: 'elfiq' },
  { id: 17, name: 'Elfliq 30ml 5% - Арбуз Лед', category: 'Жидкости', liquidType: 'Elfliq', price: 48.90, brand: 'elfiq' },
  { id: 18, name: 'Elfliq 30ml 5% - Клубника Киви', category: 'Жидкости', liquidType: 'Elfliq', price: 48.90, brand: 'elfiq' },
  
  // Другие товары
  { id: 19, name: 'Elf Bar Blueberry', category: 'Одноразки', price: 64.90, isNew: true },
  { id: 20, name: 'HQD Cuvie Plus', category: 'Одноразки', price: 59.90 },
  { id: 21, name: 'Voopoo Drag S', category: 'Поды', price: 179.90 },
  { id: 22, name: 'GeekVape Aegis', category: 'Поды', price: 214.90 },
  { id: 23, name: 'SMOK Nord 4', category: 'Поды', price: 149.90 },
  { id: 24, name: 'VOOPOO PnP Pod', category: 'Картриджи', price: 24.90 }
];

let cart = JSON.parse(localStorage.getItem('vapeCart')) || [];
let favorites = JSON.parse(localStorage.getItem('vapeFavorites')) || [];
let currentCategory = '';
let currentLiquidType = '';

// Сохранение данных
function saveData() {
  localStorage.setItem('vapeCategories', JSON.stringify(categories));
  localStorage.setItem('vapeProducts', JSON.stringify(products));
  localStorage.setItem('vapeCart', JSON.stringify(cart));
  localStorage.setItem('vapeFavorites', JSON.stringify(favorites));
  updateCartBadge();
  updateFavoritesBadge();
  updateCategoriesDisplay();
}

// Обновление счетчика корзины
function updateCartBadge() {
  document.getElementById('cart-badge').textContent = cart.length;
  document.querySelector('.nav-item:nth-child(2) .cart-badge').textContent = cart.length;
}

// Обновление счетчика избранного
function updateFavoritesBadge() {
  document.getElementById('fav-badge').textContent = favorites.length;
  document.getElementById('nav-fav-badge').textContent = favorites.length;
}

// Обновление отображения категорий
function updateCategoriesDisplay() {
  const categoriesContainer = document.getElementById('categories-container');
  categoriesContainer.innerHTML = '';
  
  categories.forEach(category => {
    const categoryCount = products.filter(p => p.category === category.name).length;
    const categoryCard = document.createElement('div');
    categoryCard.className = `category-card ${category.name === 'Жидкости' ? 'liquids' : ''}`;
    
    if (category.name === 'Жидкости') {
      categoryCard.onclick = () => openLiquidsPage();
    } else {
      categoryCard.onclick = () => openCategory(category.name);
    }
    
    categoryCard.innerHTML = `
      <div class="category-icon">
        <i class="fas ${category.icon}"></i>
      </div>
      <div class="category-name">${category.name}</div>
      <div class="category-count">${categoryCount} товаров</div>
    `;
    
    categoriesContainer.appendChild(categoryCard);
  });
  
  const categorySelect = document.getElementById('product-category');
  categorySelect.innerHTML = '<option value="" disabled selected>Выберите категорию</option>';
  
  categories.forEach(category => {
    const option = document.createElement('option');
    option.value = category.name;
    option.textContent = category.name;
    categorySelect.appendChild(option);
  });
}

// Отображение товаров
function renderProducts(productsList = products, containerId = 'products-container') {
  const container = document.getElementById(containerId);
  container.innerHTML = '';
  
  if (productsList.length === 0) {
    container.innerHTML = '<div class="empty-state"><i class="fas fa-box-open"></i><h3>Товары не найдены</h3><p>Попробуйте изменить запрос поиска</p></div>';
    return;
  }
  
  productsList.forEach(product => {
    const isFavorite = favorites.some(fav => fav.id === product.id);
    const productCard = document.createElement('div');
    productCard.className = `product-card fade-in ${product.brand || ''}`;
    
    productCard.innerHTML = `
      <div class="product-image">
        ${product.isNew ? '<div class="product-badge">NEW</div>' : ''}
        <i class="fas ${getProductIcon(product.category)}"></i>
      </div>
      <div class="product-info">
        <div class="product-name">${product.name}</div>
        <div class="product-category">${product.category}${product.liquidType ? ` · ${product.liquidType}` : ''}</div>
        <div class="product-price">${product.price.toFixed(2)} zł</div>
        <div class="product-actions">
          <button class="btn-cart" onclick="addToCart(${product.id})">В корзину</button>
          <button class="btn-fav ${isFavorite ? 'active' : ''}" onclick="toggleFavorite(${product.id})">
            <i class="${isFavorite ? 'fas' : 'far'} fa-heart"></i>
          </button>
        </div>
      </div>
    `;
    
    container.appendChild(productCard);
  });
}

// Получение иконки для категории
function getProductIcon(categoryName) {
  const category = categories.find(c => c.name === categoryName);
  return category ? category.icon : 'fa-shopping-bag';
}

// Поиск товаров
function searchProducts(query) {
  if (query.trim() === '') {
    renderProducts();
    return;
  }
  
  const filtered = products.filter(product => 
    product.name.toLowerCase().includes(query.toLowerCase()) ||
    product.category.toLowerCase().includes(query.toLowerCase()) ||
    (product.liquidType && product.liquidType.toLowerCase().includes(query.toLowerCase()))
  );
  
  renderProducts(filtered);
}

// Открытие страницы выбора жидкостей
function openLiquidsPage() {
  document.getElementById('shop-page').style.display = 'none';
  document.getElementById('category-page').style.display = 'none';
  document.getElementById('liquids-page').style.display = 'block';
  document.getElementById('liquid-type-page').style.display = 'none';
  document.getElementById('cart-page').style.display = 'none';
  document.getElementById('favorites-page').style.display = 'none';
  document.getElementById('admin-panel').style.display = 'none';
  
  document.querySelectorAll('.nav-item').forEach(item => {
    item.classList.remove('active');
  });
  document.querySelectorAll('.nav-item')[0].classList.add('active');
}

// Открытие категории жидкостей по типу
function openLiquidType(liquidType) {
  currentLiquidType = liquidType;
  
  document.getElementById('shop-page').style.display = 'none';
  document.getElementById('category-page').style.display = 'none';
  document.getElementById('liquids-page').style.display = 'none';
  document.getElementById('liquid-type-page').style.display = 'block';
  document.getElementById('cart-page').style.display = 'none';
  document.getElementById('favorites-page').style.display = 'none';
  document.getElementById('admin-panel').style.display = 'none';
  
  // Устанавливаем заголовок и описание
  const title = document.getElementById('liquid-type-title');
  const description = document.getElementById('liquid-type-description');
  const icon = document.getElementById('liquid-type-icon');
  
  title.textContent = liquidType;
  
  // Устанавливаем описание в зависимости от типа жидкости
  if (liquidType === 'Chaser Lux') {
    description.textContent = 'Премиальная линейка солей для POD-систем';
    icon.innerHTML = '<i class="fas fa-crown"></i>';
  } else if (liquidType === 'Chaser for pods') {
    description.textContent = 'Специально разработан для POD-систем';
    icon.innerHTML = '<i class="fas fa-podcast"></i>';
  } else if (liquidType === 'CHASER LIMITINI EDITINI') {
    description.textContent = 'Лимитированная серия с уникальными вкусами';
    icon.innerHTML = '<i class="fas fa-gem"></i>';
  } else if (liquidType === 'Elfliq') {
    description.textContent = 'Популярная линейка солей от Elf Bar';
    icon.innerHTML = '<i class="fas fa-leaf"></i>';
  }
  
  // Фильтруем и отображаем товары
  const liquidProducts = products.filter(product => 
    product.category === 'Жидкости' && product.liquidType === liquidType
  );
  
  renderProducts(liquidProducts, 'liquid-type-products');
}

// Возврат к выбору жидкостей
function backToLiquids() {
  document.getElementById('shop-page').style.display = 'none';
  document.getElementById('category-page').style.display = 'none';
  document.getElementById('liquids-page').style.display = 'block';
  document.getElementById('liquid-type-page').style.display = 'none';
  document.getElementById('cart-page').style.display = 'none';
  document.getElementById('favorites-page').style.display = 'none';
  document.getElementById('admin-panel').style.display = 'none';
  
  document.querySelectorAll('.nav-item').forEach(item => {
    item.classList.remove('active');
  });
  document.querySelectorAll('.nav-item')[0].classList.add('active');
}

// Открытие категории
function openCategory(categoryName) {
  currentCategory = categoryName;
  
  document.getElementById('shop-page').style.display = 'none';
  document.getElementById('category-page').style.display = 'block';
  document.getElementById('liquids-page').style.display = 'none';
  document.getElementById('liquid-type-page').style.display = 'none';
  document.getElementById('cart-page').style.display = 'none';
  document.getElementById('favorites-page').style.display = 'none';
  document.getElementById('admin-panel').style.display = 'none';
  
  document.getElementById('category-title').textContent = categoryName;
  
  const categoryProducts = products.filter(product => product.category === categoryName);
  renderProducts(categoryProducts, 'category-products');
  
  document.querySelectorAll('.nav-item').forEach(item => {
    item.classList.remove('active');
  });
  document.querySelectorAll('.nav-item')[0].classList.add('active');
}

// Возврат в магазин
function backToShop() {
  document.getElementById('shop-page').style.display = 'block';
  document.getElementById('category-page').style.display = 'none';
  document.getElementById('liquids-page').style.display = 'none';
  document.getElementById('liquid-type-page').style.display = 'none';
  document.getElementById('cart-page').style.display = 'none';
  document.getElementById('favorites-page').style.display = 'none';
  document.getElementById('admin-panel').style.display = 'none';
  
  document.querySelectorAll('.nav-item').forEach(item => {
    item.classList.remove('active');
  });
  document.querySelectorAll('.nav-item')[0].classList.add('active');
  
  renderProducts();
}

// Переход на главную
function goToHome() {
  backToShop();
}

// Показать все товары
function showAllProducts() {
  renderProducts(products);
}

// Добавление в корзину
function addToCart(productId) {
  const product = products.find(p => p.id === productId);
  if (product && !cart.some(item => item.id === productId)) {
    cart.push({...product});
    saveData();
    
    const badge = document.getElementById('cart-badge');
    badge.style.transform = 'scale(1.3)';
    setTimeout(() => {
      badge.style.transform = 'scale(1)';
    }, 300);
    
    showNotification(`Товар "${product.name}" добавлен в корзину`);
  } else if (cart.some(item => item.id === productId)) {
    showNotification('Этот товар уже в корзине');
  }
}

// Открытие страницы корзины
function openCartPage() {
  document.getElementById('shop-page').style.display = 'none';
  document.getElementById('category-page').style.display = 'none';
  document.getElementById('liquids-page').style.display = 'none';
  document.getElementById('liquid-type-page').style.display = 'none';
  document.getElementById('cart-page').style.display = 'block';
  document.getElementById('favorites-page').style.display = 'none';
  document.getElementById('admin-panel').style.display = 'none';
  
  document.querySelectorAll('.nav-item').forEach(item => {
    item.classList.remove('active');
  });
  document.querySelectorAll('.nav-item')[1].classList.add('active');
  
  renderCart();
}

// Отображение корзины
function renderCart() {
  const container = document.getElementById('cart-items-container');
  const summaryContainer = document.getElementById('cart-summary-container');
  
  if (cart.length === 0) {
    container.innerHTML = '<div class="empty-state"><i class="fas fa-shopping-cart"></i><h3>Корзина пуста</h3><p>Добавьте товары из каталога</p></div>';
    summaryContainer.innerHTML = '';
    return;
  }
  
  container.innerHTML = '';
  cart.forEach(item => {
    const cartItem = document.createElement('div');
    cartItem.className = 'cart-item fade-in';
    
    cartItem.innerHTML = `
      <div class="cart-item-image">
        <i class="fas ${getProductIcon(item.category)}"></i>
      </div>
      <div class="cart-item-info">
        <div class="cart-item-name">${item.name}</div>
        <div class="cart-item-category">${item.category}${item.liquidType ? ` · ${item.liquidType}` : ''}</div>
        <div class="cart-item-price">${item.price.toFixed(2)} zł</div>
      </div>
      <div class="cart-item-actions">
        <button class="btn-remove" onclick="removeFromCart(${item.id})">
          <i class="fas fa-trash"></i>
        </button>
      </div>
    `;
    
    container.appendChild(cartItem);
  });
  
  const total = cart.reduce((sum, item) => sum + item.price, 0);
  
  summaryContainer.innerHTML = `
    <div class="cart-summary">
      <div class="cart-total">
        <span>Итого:</span>
        <span class="cart-total-amount">${total.toFixed(2)} zł</span>
      </div>
    <a href="https://t.me/managercloudm"> <button class="telegram-payment" onclick="window.location.href='https://t.me/managercloudm';"> </a>
        <i class="fab fa-telegram" href="https://t.me/managercloudm"></i>
        Оплатить через Telegram
      </button>
      <div class="payment-info">
        <p>Для оформления заказа напишите менеджеру в Telegram:</p>
        <div class="telegram-username" href="https://t.me/managercloudm">@managercloudm</div>
        <p>Сообщите менеджеру список товаров из корзины и общую сумму</p>
      </div>
    </div>
  `;
}

// Удаление из корзины
function removeFromCart(productId) {
  const index = cart.findIndex(item => item.id === productId);
  if (index !== -1) {
    const productName = cart[index].name;
    cart.splice(index, 1);
    saveData();
    renderCart();
    showNotification(`Товар "${productName}" удален из корзины`);
  }
}

// Оформление заказа через Telegram
function processTelegramPayment() {
  if (cart.length === 0) {
    showNotification('Корзина пуста');
    return;
  }
  
  const total = cart.reduce((sum, item) => sum + item.price, 0);
  const itemsList = cart.map(item => `- ${item.name}: ${item.price.toFixed(2)} zł`).join('\n');
  const message = `Заказ из VapeHub\n\nТовары:\n${itemsList}\n\nИтого: ${total.toFixed(2)} zł\n\nДля оформления заказа свяжитесь с менеджером: @managercloudm`;
  
  showNotification(`Скопируйте информацию о заказе и отправьте менеджеру @managercloudm в Telegram`);
  
  const textArea = document.createElement('textarea');
  textArea.value = message;
  document.body.appendChild(textArea);
  textArea.select();
  document.execCommand('copy');
  document.body.removeChild(textArea);
}

// Избранное
function toggleFavorite(productId) {
  const product = products.find(p => p.id === productId);
  if (!product) return;
  
  const index = favorites.findIndex(fav => fav.id === productId);
  
  if (index === -1) {
    favorites.push({...product});
    showNotification(`Товар "${product.name}" добавлен в избранное`);
  } else {
    const productName = favorites[index].name;
    favorites.splice(index, 1);
    showNotification(`Товар "${productName}" удален из избранного`);
  }
  
  saveData();
  updateFavoritesBadge();
  
  const favButtons = document.querySelectorAll(`[onclick="toggleFavorite(${productId})"]`);
  favButtons.forEach(btn => {
    if (index === -1) {
      btn.classList.add('active');
      btn.innerHTML = '<i class="fas fa-heart"></i>';
    } else {
      btn.classList.remove('active');
      btn.innerHTML = '<i class="far fa-heart"></i>';
    }
  });
  
  if (document.getElementById('favorites-page').style.display === 'block') {
    renderFavorites();
  }
}

// Открытие избранного из хедера
function openFavorites() {
  openFavoritesPage();
}

// Открытие страницы избранного
function openFavoritesPage() {
  document.getElementById('shop-page').style.display = 'none';
  document.getElementById('category-page').style.display = 'none';
  document.getElementById('liquids-page').style.display = 'none';
  document.getElementById('liquid-type-page').style.display = 'none';
  document.getElementById('cart-page').style.display = 'none';
  document.getElementById('favorites-page').style.display = 'block';
  document.getElementById('admin-panel').style.display = 'none';
  
  document.querySelectorAll('.nav-item').forEach(item => {
    item.classList.remove('active');
  });
  document.querySelectorAll('.nav-item')[2].classList.add('active');
  
  renderFavorites();
}

// Отображение избранного
function renderFavorites() {
  const container = document.getElementById('favorites-container');
  
  if (favorites.length === 0) {
    container.innerHTML = '<div class="empty-state"><i class="fas fa-heart"></i><h3>В избранном пока ничего нет</h3><p>Добавьте товары из каталога</p></div>';
    return;
  }
  
  container.innerHTML = '';
  favorites.forEach(item => {
    const favoriteItem = document.createElement('div');
    favoriteItem.className = 'favorite-item fade-in';
    
    favoriteItem.innerHTML = `
      <div class="favorite-item-image">
        <i class="fas ${getProductIcon(item.category)}"></i>
      </div>
      <div class="favorite-item-info">
        <div class="favorite-item-name">${item.name}</div>
        <div class="favorite-item-category">${item.category}${item.liquidType ? ` · ${item.liquidType}` : ''}</div>
        <div class="favorite-item-price">${item.price.toFixed(2)} zł</div>
      </div>
      <div class="favorite-item-actions">
        <button class="btn-cart" onclick="addToCart(${item.id})">В корзину</button>
        <button class="btn-remove" onclick="toggleFavorite(${item.id})">
          <i class="fas fa-trash"></i>
        </button>
      </div>
    `;
    
    container.appendChild(favoriteItem);
  });
}

// Админ панель - переключение вкладок
function switchAdminTab(tabName) {
  document.querySelectorAll('.admin-tab').forEach(tab => {
    tab.classList.remove('active');
  });
  
  document.querySelectorAll('.admin-tab').forEach(tab => {
    if (tab.textContent === (tabName === 'products' ? 'Товары' : 'Категории')) {
      tab.classList.add('active');
    }
  });
  
  document.getElementById('products-tab').style.display = tabName === 'products' ? 'block' : 'none';
  document.getElementById('categories-tab').style.display = tabName === 'categories' ? 'block' : 'none';
  
  if (tabName === 'categories') {
    renderAdminCategoriesList();
  }
}

// Админ панель
function openAdmin() {
  document.getElementById('admin-panel').style.display = 'block';
  document.getElementById('shop-page').style.display = 'none';
  document.getElementById('category-page').style.display = 'none';
  document.getElementById('liquids-page').style.display = 'none';
  document.getElementById('liquid-type-page').style.display = 'none';
  document.getElementById('cart-page').style.display = 'none';
  document.getElementById('favorites-page').style.display = 'none';
  
  switchAdminTab('products');
  renderAdminProductsList();
}

function closeAdmin() {
  document.getElementById('admin-panel').style.display = 'none';
  document.getElementById('shop-page').style.display = 'block';
  
  document.getElementById('product-name').value = '';
  document.getElementById('product-category').value = '';
  document.getElementById('liquid-type').value = '';
  document.getElementById('product-price').value = '';
  document.getElementById('category-name').value = '';
}

function addProduct() {
  const name = document.getElementById('product-name').value;
  const category = document.getElementById('product-category').value;
  const liquidType = document.getElementById('liquid-type').value;
  const price = parseFloat(document.getElementById('product-price').value);
  
  if (!name || !category || !price) {
    showNotification('Заполните все обязательные поля');
    return;
  }
  
  if (isNaN(price) || price <= 0) {
    showNotification('Введите корректную цену');
    return;
  }
  
  // Определяем бренд по типу жидкости
  let brand = '';
  if (category === 'Жидкости') {
    if (liquidType && liquidType.includes('Chaser')) brand = 'chaser';
    if (liquidType === 'Elfliq') brand = 'elfiq';
  }
  
  const newProduct = {
    id: products.length > 0 ? Math.max(...products.map(p => p.id)) + 1 : 1,
    name,
    category,
    liquidType: (category === 'Жидкости' && liquidType) ? liquidType : undefined,
    price,
    brand,
    isNew: true
  };
  
  products.push(newProduct);
  saveData();
  renderProducts();
  renderAdminProductsList();
  
  showNotification(`Товар "${name}" добавлен`);
  
  document.getElementById('product-name').value = '';
  document.getElementById('product-category').value = '';
  document.getElementById('liquid-type').value = '';
  document.getElementById('product-price').value = '';
}

// Отображение списка товаров в админке для удаления
function renderAdminProductsList() {
  const container = document.getElementById('admin-products-list');
  
  if (products.length === 0) {
    container.innerHTML = '<div class="empty-state"><i class="fas fa-box-open"></i><h3>Нет товаров</h3><p>Добавьте товары через форму выше</p></div>';
    return;
  }
  
  container.innerHTML = '';
  products.forEach(product => {
    const adminProduct = document.createElement('div');
    adminProduct.className = 'admin-product-item fade-in';
    
    adminProduct.innerHTML = `
      <div class="admin-product-info">
        <div class="admin-product-name">${product.name}</div>
        <div class="admin-product-category">${product.category}${product.liquidType ? ` · ${product.liquidType}` : ''}</div>
      </div>
      <div style="display: flex; align-items: center;">
        <div class="admin-product-price">${product.price.toFixed(2)} zł</div>
        <div class="admin-product-actions">
          <button class="btn-delete" onclick="deleteProduct(${product.id})">
            <i class="fas fa-trash"></i>
          </button>
        </div>
      </div>
    `;
    
    container.appendChild(adminProduct);
  });
}

// Удаление товара из админки
function deleteProduct(productId) {
  const product = products.find(p => p.id === productId);
  if (!product) return;
  
  if (confirm(`Вы уверены, что хотите удалить товар "${product.name}"?`)) {
    products = products.filter(p => p.id !== productId);
    cart = cart.filter(item => item.id !== productId);
    favorites = favorites.filter(item => item.id !== productId);
    
    saveData();
    renderProducts();
    renderAdminProductsList();
    
    if (document.getElementById('cart-page').style.display === 'block') {
      renderCart();
    }
    
    if (document.getElementById('favorites-page').style.display === 'block') {
      renderFavorites();
    }
    
    showNotification(`Товар "${product.name}" удален`);
  }
}

// Управление категориями
function addCategory() {
  const name = document.getElementById('category-name').value;
  const icon = document.getElementById('category-icon').value;
  
  if (!name) {
    showNotification('Введите название категории');
    return;
  }
  
  if (categories.some(c => c.name.toLowerCase() === name.toLowerCase())) {
    showNotification('Категория с таким названием уже существует');
    return;
  }
  
  const newCategory = {
    id: categories.length > 0 ? Math.max(...categories.map(c => c.id)) + 1 : 1,
    name,
    icon,
    subcategories: []
  };
  
  categories.push(newCategory);
  saveData();
  renderAdminCategoriesList();
  
  showNotification(`Категория "${name}" добавлена`);
  
  document.getElementById('category-name').value = '';
}

// Отображение списка категорий в админке
function renderAdminCategoriesList() {
  const container = document.getElementById('admin-categories-list');
  
  if (categories.length === 0) {
    container.innerHTML = '<div class="empty-state"><i class="fas fa-tags"></i><h3>Нет категорий</h3><p>Добавьте категории через форму выше</p></div>';
    return;
  }
  
  container.innerHTML = '';
  categories.forEach(category => {
    const categoryItem = document.createElement('div');
    categoryItem.className = 'admin-category-item fade-in';
    
    const productCount = products.filter(p => p.category === category.name).length;
    
    categoryItem.innerHTML = `
      <div class="admin-category-info">
        <div class="admin-category-name">
          <i class="fas ${category.icon}" style="margin-right: 8px;"></i>
          ${category.name}
        </div>
        <div class="admin-category-count">${productCount} товаров</div>
      </div>
      <div class="admin-category-actions">
        <button class="btn-delete" onclick="deleteCategory(${category.id})">
          <i class="fas fa-trash"></i>
        </button>
      </div>
    `;
    
    container.appendChild(categoryItem);
  });
}

// Удаление категории
function deleteCategory(categoryId) {
  const category = categories.find(c => c.id === categoryId);
  if (!category) return;
  
  const productsInCategory = products.filter(p => p.category === category.name);
  
  if (productsInCategory.length > 0) {
    if (!confirm(`В категории "${category.name}" есть ${productsInCategory.length} товаров. При удалении категории эти товары также будут удалены. Продолжить?`)) {
      return;
    }
    
    products = products.filter(p => p.category !== category.name);
    cart = cart.filter(item => item.category !== category.name);
    favorites = favorites.filter(item => item.category !== category.name);
  }
  
  categories = categories.filter(c => c.id !== categoryId);
  saveData();
  renderAdminCategoriesList();
  renderProducts();
  
  showNotification(`Категория "${category.name}" удалена`);
}

// Уведомление
function showNotification(message) {
  const notification = document.createElement('div');
  notification.style.cssText = `
    position: fixed;
    top: 100px;
    left: 50%;
    transform: translateX(-50%);
    background: var(--primary);
    color: white;
    padding: 15px 25px;
    border-radius: 12px;
    box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
    z-index: 1000;
    font-weight: 600;
    animation: fadeIn 0.3s;
    max-width: 90%;
    text-align: center;
  `;
  notification.textContent = message;
  
  document.body.appendChild(notification);
  
  setTimeout(() => {
    notification.style.opacity = '0';
    notification.style.transition = 'opacity 0.5s';
    setTimeout(() => {
      document.body.removeChild(notification);
    }, 500);
  }, 3000);
}

// Инициализация при загрузке
document.addEventListener('DOMContentLoaded', function() {
  renderProducts();
  updateCartBadge();
  updateFavoritesBadge();
  updateCategoriesDisplay();
  
  document.querySelectorAll('.category-card, .product-card').forEach((card, index) => {
    card.style.animationDelay = `${index * 0.1}s`;
  });
});
</script>
</body>
</html>
